syntax = "proto3";

package recipe.v1;

option go_package = "github.com/platepilot/backend/internal/recipe/pb";

// Service definition for recipe management
service RecipeService {
  // Gets a recipe by its ID
  rpc GetRecipeById (GetRecipeByIdRequest) returns (RecipeResponse);

  // Gets a paginated list of all recipes
  rpc GetAllRecipes (GetAllRecipesRequest) returns (GetAllRecipesResponse);

  // Creates a new recipe
  rpc CreateRecipe (CreateRecipeRequest) returns (RecipeResponse);

  // Gets recipes similar to a given recipe
  rpc GetSimilarRecipes (GetSimilarRecipesRequest) returns (GetAllRecipesResponse);

  // Gets recipes by cuisine
  rpc GetRecipesByCuisine (GetRecipesByCuisineRequest) returns (GetAllRecipesResponse);

  // Gets recipes by ingredient
  rpc GetRecipesByIngredient (GetRecipesByIngredientRequest) returns (GetAllRecipesResponse);

  // Gets recipes avoiding an allergy
  rpc GetRecipesByAllergy (GetRecipesByAllergyRequest) returns (GetAllRecipesResponse);
}

// Request for getting a recipe by ID
message GetRecipeByIdRequest {
  string recipe_id = 1; // UUID string
  string user_id = 2; // UUID string
}

// Request for getting all recipes with pagination
message GetAllRecipesRequest {
  int32 page_index = 1;
  int32 page_size = 2;
  string user_id = 3; // UUID string
}

// Response containing multiple recipes with pagination
message GetAllRecipesResponse {
  repeated RecipeResponse recipes = 1;
  int32 page_index = 2;
  int32 page_size = 3;
  int32 total_count = 4;
  int32 total_pages = 5;
}

// Request for creating a new recipe
message CreateRecipeRequest {
  string name = 1;
  string description = 2;
  string prep_time = 3;
  string cook_time = 4;
  string main_ingredient_id = 5; // UUID string
  string cuisine_id = 6; // UUID string
  repeated string ingredient_ids = 7; // UUID strings
  repeated string directions = 8;
  string user_id = 9; // UUID string
  string main_ingredient_name = 10;
  string cuisine_name = 11;
  repeated string ingredient_names = 12;
  repeated string tags = 13;
  bool guided_mode = 14;
}

// Request for getting similar recipes
message GetSimilarRecipesRequest {
  string recipe_id = 1; // UUID string
  int32 amount = 2;
  string user_id = 3; // UUID string
}

// Request for getting recipes by cuisine
message GetRecipesByCuisineRequest {
  string cuisine_id = 1; // UUID string
  string user_id = 2; // UUID string
}

// Request for getting recipes by ingredient
message GetRecipesByIngredientRequest {
  string ingredient_id = 1; // UUID string
  string user_id = 2; // UUID string
}

// Request for getting recipes avoiding an allergy
message GetRecipesByAllergyRequest {
  string allergy_id = 1; // UUID string
  string user_id = 2; // UUID string
}

// Response containing recipe details
message RecipeResponse {
  string id = 1; // UUID string
  string name = 2;
  string description = 3;
  string prep_time = 4;
  string cook_time = 5;
  Ingredient main_ingredient = 6;
  Cuisine cuisine = 7;
  repeated Ingredient ingredients = 8;
  repeated string directions = 9;
}

// Ingredient entity
message Ingredient {
  string id = 1; // UUID string
  string name = 2;
}

// Cuisine entity
message Cuisine {
  string id = 1; // UUID string
  string name = 2;
}
